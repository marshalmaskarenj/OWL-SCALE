"""
This component recreates the CIE S026 alpha-opic toolbox, for the selected alpha_opic datasets. Alpha-type needs to be defined as input. 
This follows the recipe of PerezSky/CIE_Skygen/HDR2DiscreteLumEx --> Spectralskydome/Spectralviewdome --> CCT2SPD/viewCCT2SPD --> RelativeCombinedSPD --> comb2CIES026 --> spd_input of this component.
"spd_input" needs to be 54 x 2 array of SPDs from 300 to 830 nms, separated by 10nm interval.
---
OWL (Occupant Well-being through Lighting) is developed by Marshal Maskarenj, for SCALE project funded by FNRS @ LOCI, UCLouvain.
    Inputs:
        spd_input: 54 x 2 array of SPDs from 300 to 830 nms, separated by 10nm interval. The output of SCALE_comb2CIES026 connects here.
        alpha_type: (between 1 and 5) 1 for s-cone-opic, 2 for m-cone-opic, 3 for l-cone-opic, 4 for rhod-opic and 5 for melan-opic.
        net_illum: The overall illum at the horizontal plane or at the eye level. Connects to output from SCALE_RelativeCombinedSPD component.
    Output:
        illuminance: Factoring-in the photopic function * 683 (luminous efficacy in lum/W). This is in Lux.
        a_opic_irradiance: Factoring in the respective a_opic function, this data is in W/(sqm.sr)
        a_opic_ELR: a_opic Efficacy of Luminous Radiation, this is the same as 1000*{a_opic_irradiance/illuminance} and is in mW/lm
        a_opic_DER: a_opic Daylight (D65) efficacy ratio. This is {opic_ELR-for-source/opic_ELR-for-D65}. opic_ELR-for-D65 is 0.8173 (for 'S'), 1.4458 (for 'M'), 1.6289 (for 'L'),  1.4497 (for 'Rh') and 1.3262 (for 'mel') mW/lm, so this is unitless. 
        a_opic_EDI: a_opic Equivalent Daylight (D65) Illuminance. This is {illuminance*opic_DER}, and is in Lux ."""
self=ghenv.Component
self.Name = "SCALE_CIES026_aopic"
self.NickName = 'CIES026_aopic'
self.Message = 'OWL 0.0.01\nOCT_15_2021'
self.IconDisplayMode = self.IconDisplayMode.application
self.Category = "SCALE"
self.SubCategory = "3 OWL::Spectral"
try: self.AdditionalHelpFromDocStrings = "3"
except: pass

import rhinoscriptsyntax as rs
import math
import csv

def interpolate(inp, fi):
    i, f = int(fi // 1), fi % 1  # Split floating-point index into whole & fractional parts.
    j = i+1 if f > 0 else i  # Avoid index error.
    return (1-f) * inp[i] + f * inp[j]

def main(spd_org,alpha_type,net_illum):# 0.8173 (for 'S'), 1.4458 (for 'M'), 1.6289 (for 'L'),  1.4497 (for 'Rh') and 1.3262 (for 'mel')
    if alpha_type ==1:
        opic_array=[0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0061426500,0.0074428000,0.0090166100,0.0109170000,0.0132053000,0.0159515000,0.0192347000,0.0231436000,0.0277750000,0.0332339000,0.0396308000,0.0470801000,0.0557012000,0.0656137000,0.0769323000,0.0897612000,0.1041880000,0.1202730000,0.1380440000,0.1574850000,0.1785300000,0.2010770000,0.2250910000,0.2505660000,0.2775070000,0.3059410000,0.3358580000,0.3669810000,0.3988760000,0.4309980000,0.4626920000,0.4933570000,0.5230060000,0.5519390000,0.5805990000,0.6095700000,0.6393590000,0.6696510000,0.6998290000,0.7291770000,0.7568850000,0.7822920000,0.8056660000,0.8275990000,0.8487800000,0.8699840000,0.8917610000,0.9134440000,0.9339770000,0.9522180000,0.9669600000,0.9773400000,0.9840280000,0.9881440000,0.9908510000,0.9933360000,0.9963730000,0.9990380000,0.9999780000,0.9978440000,0.9913290000,0.9796570000,0.9639050000,0.9455730000,0.9260780000,0.9067350000,0.8885090000,0.8713530000,0.8549980000,0.8391980000,0.8237260000,0.8083070000,0.7924310000,0.7755690000,0.7572440000,0.7370430000,0.7147300000,0.6905580000,0.6648900000,0.6380780000,0.6104560000,0.5823460000,0.5540650000,0.5259030000,0.4981080000,0.4708940000,0.4444500000,0.4189920000,0.3946990000,0.3717070000,0.3501080000,0.3299040000,0.3108640000,0.2927410000,0.2753380000,0.2584970000,0.2421580000,0.2265040000,0.2117260000,0.1979600000,0.1852970000,0.1737510000,0.1631490000,0.1533110000,0.1440860000,0.1353510000,0.1270110000,0.1190170000,0.1113330000,0.1039340000,0.0967990000,0.0899169000,0.0832878000,0.0769157000,0.0708052000,0.0649614000,0.0594049000,0.0542076000,0.0494281000,0.0450993000,0.0412337000,0.0378142000,0.0347627000,0.0320029000,0.0294746000,0.0271300000,0.0249376000,0.0228931000,0.0209956000,0.0192427000,0.0176298000,0.0161501000,0.0147911000,0.0135407000,0.0123884000,0.0113252000,0.0103437000,0.0094409200,0.0086136500,0.0078583100,0.0071708900,0.0065464800,0.0059777700,0.0054579400,0.0049812500,0.0045428700,0.0041390800,0.0037679400,0.0034278300,0.0031169600,0.0028335200,0.0025755600,0.0023408400,0.0021272200,0.0019327600,0.0017557300,0.0015945500,0.0014478300,0.0013143000,0.0011928100,0.0010823000,0.0009818190,0.0008905330,0.0008076870,0.0007325680,0.0006645120,0.0006028870,0.0005470620,0.0004964610,0.0004505710,0.0004089310,0.0003711360,0.0003368380,0.0003057230,0.0002775040,0.0002519180,0.0002287250,0.0002076990,0.0001886380,0.0001713570,0.0001556880,0.0001414800,0.0001285960,0.0001169120,0.0001063160,0.0000967045,0.0000879858,0.0000800756,0.0000728979,0.0000663837,0.0000604705,0.0000551020,0.0000502269,0.0000457988,0.0000417759,0.0000381202,0.0000347974,0.0000317763,0.0000290288,0.0000265294,0.0000242549,0.0000221847,0.0000202996,0.0000185826,0.0000170182,0.0000155924,0.0000142924,0.0000131066,0.0000120248,0.0000110373,0.0000101356,0.0000093120,0.0000085594,0.0000078714,0.0000072422,0.0000066666,0.0000061397,0.0000056573,0.0000052154,0.0000048104,0.0000044391,0.0000040985,0.0000037860,0.0000034991,0.0000032356,0.0000029935,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000]
        alpha_ELR_DL=0.8173
        atype="s-cone-opic"
    elif alpha_type==2:
        opic_array=[0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0003582270,0.0004386600,0.0005362300,0.0006540610,0.0007956490,0.0009648280,0.0011657200,0.0014026300,0.0016799200,0.0020018000,0.0023720800,0.0027943300,0.0032737400,0.0038166000,0.0044302100,0.0051231600,0.0059045800,0.0067800500,0.0077526000,0.0088228600,0.0099884100,0.0112452000,0.0125949000,0.0140425000,0.0155944000,0.0172596000,0.0190467000,0.0209545000,0.0229763000,0.0251017000,0.0273163000,0.0296062000,0.0319746000,0.0344330000,0.0369983000,0.0396928000,0.0425402000,0.0455474000,0.0487161000,0.0520467000,0.0555384000,0.0591876000,0.0629819000,0.0669031000,0.0709285000,0.0750299000,0.0791769000,0.0833463000,0.0875160000,0.0916625000,0.0957612000,0.0997977000,0.1038040000,0.1078340000,0.1119480000,0.1162200000,0.1207060000,0.1253630000,0.1301110000,0.1348560000,0.1394930000,0.1439430000,0.1482810000,0.1526370000,0.1571570000,0.1620060000,0.1673310000,0.1731440000,0.1794170000,0.1861170000,0.1932020000,0.2006210000,0.2083150000,0.2162120000,0.2242310000,0.2322750000,0.2402570000,0.2481600000,0.2559870000,0.2637440000,0.2714410000,0.2790970000,0.2867550000,0.2944760000,0.3023230000,0.3103720000,0.3186920000,0.3273070000,0.3362320000,0.3454800000,0.3550660000,0.3649850000,0.3751420000,0.3854100000,0.3956460000,0.4056880000,0.4154350000,0.4250640000,0.4348510000,0.4450970000,0.4561370000,0.4682360000,0.4812550000,0.4949270000,0.5089470000,0.5229700000,0.5367010000,0.5501950000,0.5636160000,0.5771500000,0.5910030000,0.6053500000,0.6201600000,0.6353430000,0.6507960000,0.6664040000,0.6820550000,0.6976720000,0.7131860000,0.7285260000,0.7436120000,0.7583960000,0.7729660000,0.7874570000,0.8020170000,0.8168080000,0.8319190000,0.8470960000,0.8619720000,0.8761520000,0.8892140000,0.9008120000,0.9110060000,0.9199680000,0.9278900000,0.9349770000,0.9414140000,0.9472790000,0.9526220000,0.9574980000,0.9619620000,0.9660800000,0.9699660000,0.9737430000,0.9775390000,0.9814810000,0.9856290000,0.9897540000,0.9935510000,0.9967140000,0.9989310000,0.9999420000,0.9996920000,0.9981780000,0.9954050000,0.9913830000,0.9861990000,0.9802290000,0.9739060000,0.9676530000,0.9618760000,0.9568200000,0.9521510000,0.9473980000,0.9421050000,0.9358290000,0.9282740000,0.9196670000,0.9103560000,0.9006770000,0.8909490000,0.8813860000,0.8718340000,0.8620590000,0.8518400000,0.8409690000,0.8293030000,0.8169110000,0.8039100000,0.7904130000,0.7765260000,0.7623110000,0.7476690000,0.7324760000,0.7166220000,0.7000130000,0.6826470000,0.6648170000,0.6468580000,0.6290720000,0.6117280000,0.5949980000,0.5787830000,0.5629350000,0.5473210000,0.5318250000,0.5163540000,0.5008700000,0.4853500000,0.4697770000,0.4541420000,0.4384540000,0.4227780000,0.4071880000,0.3917520000,0.3765270000,0.3615590000,0.3468560000,0.3324220000,0.3182610000,0.3043780000,0.2907840000,0.2775060000,0.2645750000,0.2520120000,0.2398370000,0.2280650000,0.2167030000,0.2057540000,0.1952210000,0.1851040000,0.1753980000,0.1660910000,0.1571690000,0.1486200000,0.1404310000,0.1325910000,0.1250920000,0.1179280000,0.1110910000,0.1045730000,0.0983663000,0.0924685000,0.0868759000,0.0815834000,0.0765841000,0.0718683000,0.0674186000,0.0632176000,0.0592492000,0.0554990000,0.0519550000,0.0486103000,0.0454591000,0.0424945000,0.0397097000,0.0370952000,0.0346347000,0.0323125000,0.0301151000,0.0280314000,0.0260564000,0.0242011000,0.0224760000,0.0208870000,0.0194366000,0.0181200000,0.0169149000,0.0157991000,0.0147543000,0.0137660000,0.0128246000,0.0119304000,0.0110850000,0.0102892000,0.0095431500,0.0088460900,0.0081960000,0.0075905900,0.0070275400,0.0065045500,0.0060195200,0.0055709300,0.0051572800,0.0047768700,0.0044279400,0.0041083200,0.0038147000,0.0035439200,0.0032932900,0.0030605000,0.0028436900,0.0026417500,0.0024537400,0.0022787500,0.0021159600,0.0019645600,0.0018237800,0.0016928700,0.0015711500,0.0014579800,0.0013527400,0.0012547600,0.0011634000,0.0010781200,0.0009984240,0.0009239620,0.0008547130,0.0007906520,0.0007316840,0.0006776530,0.0006282970,0.0005831080,0.0005415840,0.0005032940,0.0004678700,0.0004350070,0.0004044900,0.0003761380,0.0003497840,0.0003252780,0.0003024770,0.0002812370,0.0002614270,0.0002429300,0.0002256410,0.0002094780,0.0001944000,0.0001803700,0.0001673470,0.0001552860,0.0001441350,0.0001338300,0.0001243090,0.0001155130,0.0001073880,0.0000998800,0.0000929320,0.0000864907,0.0000805090,0.0000749453,0.0000697652,0.0000649470,0.0000604718,0.0000563207,0.0000524748,0.0000489142,0.0000456137,0.0000425490,0.0000396989,0.0000370443,0.0000345688,0.0000322588,0.0000301026,0.0000280893,0.0000262088,0.0000244529,0.0000228177,0.0000212995,0.0000198941,0.0000185965,0.0000174003,0.0000162931,0.0000152632,0.0000143005,0.0000133965,0.0000125449,0.0000117441,0.0000109929,0.0000102900,0.0000096340,0.0000090226,0.0000084530,0.0000079221,0.0000074270,0.0000069652,0.0000065342,0.0000061313,0.0000057539,0.0000053998,0.0000050671,0.0000047541,0.0000044602,0.0000041847,0.0000039269,0.0000036862,0.0000034616,0.0000032516,0.0000030546,0.0000028695,0.0000026950,0.0000025304,0.0000023755,0.0000022303,0.0000020948,0.0000019686,0.0000018515,0.0000017425,0.0000016406,0.0000015451,0.0000014552]
        alpha_ELR_DL=1.4558
        atype="m-cone-opic"
    elif alpha_type==3:
        opic_array=[0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.0004076190,0.0004970680,0.0006047130,0.0007336400,0.0008872470,0.0010692100,0.0012834000,0.0015338200,0.0018244300,0.0021589600,0.0025407300,0.0029728200,0.0034599300,0.0040079300,0.0046237000,0.0053154600,0.0060913800,0.0069529100,0.0078963400,0.0089130000,0.0099883500,0.0111054000,0.0122607000,0.0134578000,0.0147044000,0.0160130000,0.0173958000,0.0188452000,0.0203440000,0.0218700000,0.0233957000,0.0248961000,0.0263761000,0.0278541000,0.0293551000,0.0309104000,0.0325498000,0.0342714000,0.0360620000,0.0379052000,0.0397810000,0.0416705000,0.0435728000,0.0454932000,0.0474385000,0.0494172000,0.0514343000,0.0534735000,0.0555102000,0.0575166000,0.0594619000,0.0613240000,0.0631288000,0.0649189000,0.0667425000,0.0686538000,0.0706963000,0.0728508000,0.0750778000,0.0773325000,0.0795647000,0.0817368000,0.0838826000,0.0860598000,0.0883322000,0.0907704000,0.0934397000,0.0963577000,0.0995304000,0.1029640000,0.1066630000,0.1106290000,0.1148280000,0.1192170000,0.1237400000,0.1283360000,0.1329470000,0.1375700000,0.1422180000,0.1469050000,0.1516510000,0.1564750000,0.1614040000,0.1664640000,0.1716900000,0.1771160000,0.1827770000,0.1886850000,0.1948450000,0.2012610000,0.2079400000,0.2148750000,0.2220220000,0.2293160000,0.2366840000,0.2440460000,0.2513470000,0.2586950000,0.2662520000,0.2742020000,0.2827520000,0.2920710000,0.3020940000,0.3126730000,0.3236370000,0.3347860000,0.3459430000,0.3571260000,0.3684160000,0.3799070000,0.3917050000,0.4039050000,0.4165000000,0.4294530000,0.4427200000,0.4562520000,0.4699970000,0.4839260000,0.4980120000,0.5122270000,0.5265380000,0.5409230000,0.5554060000,0.5700250000,0.5848280000,0.5998670000,0.6151620000,0.6305690000,0.6458830000,0.6608800000,0.6753130000,0.6889750000,0.7018860000,0.7141400000,0.7258410000,0.7371080000,0.7480460000,0.7586840000,0.7690320000,0.7790990000,0.7889000000,0.7984720000,0.8079450000,0.8174780000,0.8272390000,0.8374030000,0.8480780000,0.8590640000,0.8700680000,0.8807790000,0.8908710000,0.9000570000,0.9082530000,0.9154330000,0.9215750000,0.9266600000,0.9307440000,0.9341600000,0.9373180000,0.9406340000,0.9445270000,0.9492910000,0.9546800000,0.9603090000,0.9657850000,0.9707030000,0.9747560000,0.9780550000,0.9808190000,0.9832710000,0.9856360000,0.9880850000,0.9905600000,0.9929450000,0.9951240000,0.9969790000,0.9984110000,0.9993910000,0.9999120000,0.9999650000,0.9995430000,0.9986150000,0.9970510000,0.9947010000,0.9914160000,0.9870570000,0.9815990000,0.9754510000,0.9691200000,0.9630930000,0.9578410000,0.9536640000,0.9502360000,0.9470860000,0.9437520000,0.9397810000,0.9348260000,0.9289170000,0.9221770000,0.9147290000,0.9066930000,0.8981700000,0.8891880000,0.8797590000,0.8698940000,0.8596050000,0.8489120000,0.8378650000,0.8265220000,0.8149400000,0.8031730000,0.7912530000,0.7791180000,0.7666910000,0.7539000000,0.7406800000,0.7269950000,0.7129050000,0.6984910000,0.6838290000,0.6689910000,0.6540370000,0.6389790000,0.6238250000,0.6085790000,0.5932480000,0.5778570000,0.5624930000,0.5472480000,0.5322090000,0.5174490000,0.5029930000,0.4886920000,0.4743760000,0.4598960000,0.4451250000,0.4300070000,0.4146870000,0.3993400000,0.3841220000,0.3691680000,0.3545800000,0.3403890000,0.3266090000,0.3132490000,0.3003160000,0.2878170000,0.2757620000,0.2641580000,0.2530090000,0.2423160000,0.2320610000,0.2221580000,0.2125160000,0.2030600000,0.1937300000,0.1844950000,0.1754020000,0.1665090000,0.1578650000,0.1495090000,0.1414700000,0.1337600000,0.1263830000,0.1193430000,0.1126380000,0.1062640000,0.1002080000,0.0944558000,0.0889934000,0.0838077000,0.0788866000,0.0742192000,0.0697953000,0.0656050000,0.0616384000,0.0578857000,0.0543366000,0.0509811000,0.0478096000,0.0448132000,0.0419831000,0.0393111000,0.0367892000,0.0344098000,0.0321660000,0.0300509000,0.0280594000,0.0261861000,0.0244260000,0.0227738000,0.0212238000,0.0197679000,0.0183986000,0.0171092000,0.0158939000,0.0147492000,0.0136773000,0.0126804000,0.0117590000,0.0109123000,0.0101373000,0.0094256800,0.0087691700,0.0081607600,0.0075945300,0.0070658800,0.0065725200,0.0061126200,0.0056844000,0.0052860700,0.0049157300,0.0045708600,0.0042490800,0.0039483200,0.0036667500,0.0034029700,0.0031563200,0.0029262400,0.0027121300,0.0025132700,0.0023289500,0.0021583600,0.0020007100,0.0018552100,0.0017210800,0.0015975000,0.0014834200,0.0013778700,0.0012799800,0.0011890000,0.0011043300,0.0010256300,0.0009526020,0.0008849590,0.0008223960,0.0007645850,0.0007111100,0.0006615700,0.0006156120,0.0005729170,0.0005332060,0.0004962340,0.0004617820,0.0004296540,0.0003996700,0.0003716900,0.0003456500,0.0003214940,0.0002991550,0.0002785530,0.0002595830,0.0002420610,0.0002258090,0.0002106740,0.0001965280,0.0001832710,0.0001708680,0.0001592900,0.0001485060,0.0001384820,0.0001291790,0.0001205420,0.0001125190,0.0001050610,0.0000981226,0.0000916641,0.0000856455,0.0000800302,0.0000747858,0.0000698827,0.0000652966,0.0000610128,0.0000570183,0.0000532996,0.0000498430,0.0000466322,0.0000436424,0.0000408501,0.0000382346,0.0000357781,0.0000334676,0.0000313007,0.0000292761,0.0000273908,0.0000256411,0.0000240205,0.0000225160,0.0000211145,0.0000198046,0.0000185766]
        alpha_ELR_DL=1.6289
        atype="l-cone-opic"
    elif alpha_type==4:
        opic_array=[0.0005890000,0.0006650000,0.0007520000,0.0008540000,0.0009720000,0.0011080000,0.0012680000,0.0014530000,0.0016680000,0.0019180000,0.0022090000,0.0025470000,0.0029390000,0.0033940000,0.0039210000,0.0045300000,0.0052400000,0.0060500000,0.0069800000,0.0080600000,0.0092900000,0.0107000000,0.0123100000,0.0141300000,0.0161900000,0.0185200000,0.0211300000,0.0240500000,0.0273000000,0.0308900000,0.0348400000,0.0391600000,0.0439000000,0.0490000000,0.0545000000,0.0604000000,0.0668000000,0.0736000000,0.0808000000,0.0885000000,0.0966000000,0.1052000000,0.1141000000,0.1235000000,0.1334000000,0.1436000000,0.1541000000,0.1651000000,0.1764000000,0.1879000000,0.1998000000,0.2119000000,0.2243000000,0.2369000000,0.2496000000,0.2625000000,0.2755000000,0.2886000000,0.3017000000,0.3149000000,0.3281000000,0.3412000000,0.3543000000,0.3673000000,0.3803000000,0.3931000000,0.4060000000,0.4180000000,0.4310000000,0.4430000000,0.4550000000,0.4670000000,0.4790000000,0.4900000000,0.5020000000,0.5130000000,0.5240000000,0.5350000000,0.5460000000,0.5570000000,0.5670000000,0.5780000000,0.5880000000,0.5990000000,0.6100000000,0.6200000000,0.6310000000,0.6420000000,0.6530000000,0.6640000000,0.6760000000,0.6870000000,0.6990000000,0.7100000000,0.7220000000,0.7340000000,0.7450000000,0.7570000000,0.7690000000,0.7810000000,0.7930000000,0.8050000000,0.8170000000,0.8280000000,0.8400000000,0.8510000000,0.8620000000,0.8730000000,0.8840000000,0.8940000000,0.9040000000,0.9140000000,0.9230000000,0.9320000000,0.9410000000,0.9490000000,0.9570000000,0.9640000000,0.9700000000,0.9760000000,0.9820000000,0.9860000000,0.9900000000,0.9940000000,0.9970000000,0.9980000000,1.0000000000,1.0000000000,1.0000000000,0.9980000000,0.9970000000,0.9940000000,0.9900000000,0.9860000000,0.9810000000,0.9750000000,0.9680000000,0.9610000000,0.9530000000,0.9440000000,0.9350000000,0.9250000000,0.9150000000,0.9040000000,0.8920000000,0.8800000000,0.8670000000,0.8540000000,0.8400000000,0.8260000000,0.8110000000,0.7960000000,0.7810000000,0.7650000000,0.7490000000,0.7330000000,0.7170000000,0.7000000000,0.6830000000,0.6670000000,0.6500000000,0.6330000000,0.6160000000,0.5990000000,0.5810000000,0.5640000000,0.5480000000,0.5310000000,0.5140000000,0.4970000000,0.4810000000,0.4650000000,0.4480000000,0.4330000000,0.4170000000,0.4020000000,0.3864000000,0.3715000000,0.3569000000,0.3427000000,0.3288000000,0.3151000000,0.3018000000,0.2888000000,0.2762000000,0.2639000000,0.2519000000,0.2403000000,0.2291000000,0.2182000000,0.2076000000,0.1974000000,0.1876000000,0.1782000000,0.1690000000,0.1602000000,0.1517000000,0.1436000000,0.1358000000,0.1284000000,0.1212000000,0.1143000000,0.1078000000,0.1015000000,0.0956000000,0.0899000000,0.0845000000,0.0793000000,0.0745000000,0.0699000000,0.0655000000,0.0613000000,0.0574000000,0.0537000000,0.0502000000,0.0469000000,0.0438000000,0.0409000000,0.0381600000,0.0355800000,0.0331500000,0.0308700000,0.0287400000,0.0267400000,0.0248700000,0.0231200000,0.0214700000,0.0199400000,0.0185100000,0.0171800000,0.0159300000,0.0147700000,0.0136900000,0.0126900000,0.0117500000,0.0108800000,0.0100700000,0.0093200000,0.0086200000,0.0079700000,0.0073700000,0.0068200000,0.0063000000,0.0058200000,0.0053800000,0.0049700000,0.0045900000,0.0042400000,0.0039130000,0.0036130000,0.0033350000,0.0030790000,0.0028420000,0.0026230000,0.0024210000,0.0022350000,0.0020620000,0.0019030000,0.0017570000,0.0016210000,0.0014970000,0.0013820000,0.0012760000,0.0011780000,0.0010880000,0.0010050000,0.0009280000,0.0008570000,0.0007920000,0.0007320000,0.0006770000,0.0006260000,0.0005790000,0.0005360000,0.0004960000,0.0004590000,0.0004250000,0.0003935000,0.0003645000,0.0003377000,0.0003129000,0.0002901000,0.0002689000,0.0002493000,0.0002313000,0.0002146000,0.0001991000,0.0001848000,0.0001716000,0.0001593000,0.0001480000,0.0001375000,0.0001277000,0.0001187000,0.0001104000,0.0001026000,0.0000954000,0.0000888000,0.0000826000,0.0000769000,0.0000715000,0.0000666000,0.0000620000,0.0000578000,0.0000538000,0.0000501000,0.0000467000,0.0000436000,0.0000406000,0.0000378900,0.0000353300,0.0000329500,0.0000307500,0.0000287000,0.0000267900,0.0000250100,0.0000233600,0.0000218200,0.0000203800,0.0000190500,0.0000178000,0.0000166400,0.0000155600,0.0000145400,0.0000136000,0.0000127300,0.0000119100,0.0000111400,0.0000104300,0.0000097600,0.0000091400,0.0000085600,0.0000080200,0.0000075100,0.0000070400,0.0000066000,0.0000061800,0.0000058000,0.0000054400,0.0000051000,0.0000047800,0.0000044900,0.0000042100,0.0000039510,0.0000037090,0.0000034820,0.0000032700,0.0000030700,0.0000028840,0.0000027100,0.0000025460,0.0000023930,0.0000022500,0.0000021150,0.0000019890,0.0000018700,0.0000017590,0.0000016550,0.0000015570,0.0000014660,0.0000013790,0.0000012990,0.0000012230,0.0000011510,0.0000010840,0.0000010220,0.0000009620,0.0000009070,0.0000008550,0.0000008060,0.0000007600,0.0000007160,0.0000006750,0.0000006370,0.0000006010,0.0000005670,0.0000005350,0.0000005050,0.0000004770,0.0000004500,0.0000004250,0.0000004010,0.0000003790,0.0000003580,0.0000003382,0.0000003196,0.0000003021,0.0000002855,0.0000002699,0.0000002552,0.0000002413,0.0000002282,0.0000002159,0.0000002042,0.0000001932,0.0000001829,0.0000001731,0.0000001638,0.0000001551,0.0000001468,0.0000001390]
        alpha_ELR_DL=1.4497
        atype="rhod-opic"
    else:
        opic_array=[0.000918165,0.001045570,0.001178580,0.001322790,0.001483810,0.001667240,0.001881020,0.002129890,0.002414570,0.002735830,0.003094420,0.003507060,0.003990780,0.004546790,0.005176250,0.005880350,0.006693340,0.007651020,0.008756940,0.010014600,0.011427700,0.013076700,0.015039700,0.017316600,0.019907100,0.022811200,0.026319400,0.030596400,0.035453800,0.040702800,0.046155000,0.051782200,0.057780400,0.064297200,0.071480100,0.079476600,0.089180700,0.100756000,0.113256000,0.125732000,0.137237000,0.147446000,0.157014000,0.166463000,0.176316000,0.187096000,0.199210000,0.212408000,0.226225000,0.240199000,0.253865000,0.267021000,0.279976000,0.293034000,0.306500000,0.320679000,0.336016000,0.352361000,0.369128000,0.385732000,0.401587000,0.416472000,0.430797000,0.444921000,0.459203000,0.474002000,0.489517000,0.505522000,0.521741000,0.537898000,0.553715000,0.569100000,0.584240000,0.599281000,0.614370000,0.629654000,0.645193000,0.660892000,0.676660000,0.692409000,0.708049000,0.723594000,0.739105000,0.754560000,0.769938000,0.785216000,0.800683000,0.816354000,0.831798000,0.846587000,0.860291000,0.872925000,0.884870000,0.896242000,0.907158000,0.917734000,0.928345000,0.938950000,0.949035000,0.958091000,0.965605000,0.971976000,0.977833000,0.983006000,0.987325000,0.990621000,0.993343000,0.995887000,0.998008000,0.999461000,1.000000000,0.999561000,0.998365000,0.996590000,0.994416000,0.992022000,0.988792000,0.984220000,0.978657000,0.972451000,0.965952000,0.958844000,0.950716000,0.941778000,0.932236000,0.922299000,0.911832000,0.900602000,0.888663000,0.876073000,0.862888000,0.848801000,0.833678000,0.817832000,0.801579000,0.785233000,0.768718000,0.751807000,0.734593000,0.717169000,0.699628000,0.681888000,0.663881000,0.645724000,0.627533000,0.609422000,0.591339000,0.573207000,0.555105000,0.537112000,0.519309000,0.501645000,0.484067000,0.466643000,0.449442000,0.432533000,0.415862000,0.399372000,0.383136000,0.367224000,0.351707000,0.336537000,0.321647000,0.307085000,0.292899000,0.279135000,0.265737000,0.252648000,0.239917000,0.227592000,0.215722000,0.204238000,0.193075000,0.182288000,0.171930000,0.162056000,0.152601000,0.143487000,0.134748000,0.126416000,0.118526000,0.111007000,0.103793000,0.096920600,0.090425900,0.084345700,0.078619800,0.073175000,0.068028800,0.063198400,0.058701300,0.054483200,0.050488900,0.046734400,0.043235700,0.040008900,0.037010200,0.034190300,0.031556200,0.029115300,0.026874700,0.024801400,0.022859700,0.021053400,0.019386400,0.017862400,0.016457800,0.015147000,0.013931400,0.012812000,0.011790100,0.010848800,0.009971120,0.009158500,0.008412420,0.007734300,0.007112550,0.006534760,0.006001100,0.005511740,0.005066860,0.004658690,0.004279460,0.003929390,0.003608720,0.003317660,0.003051090,0.002803740,0.002575600,0.002366680,0.002176980,0.002003170,0.001841900,0.001693170,0.001556920,0.001433140,0.001319720,0.001214510,0.001117430,0.001028390,0.000947313,0.000872814,0.000803576,0.000739620,0.000680970,0.000627648,0.000578753,0.000533358,0.000491440,0.000452980,0.000417955,0.000385789,0.000355905,0.000328289,0.000302926,0.000279801,0.000258544,0.000238785,0.000220508,0.000203699,0.000188341,0.000174192,0.000161020,0.000148821,0.000137594,0.000127337,0.000117891,0.000109096,0.000100949,0.000093444,0.000086575,0.000080241,0.000074338,0.000068865,0.000063817,0.000059191,0.000054920,0.000050937,0.000047240,0.000043827,0.000040695,0.000037799,0.000035097,0.000032586,0.000030265,0.000028132,0.000026159,0.000024316,0.000022602,0.000021015,0.000019554,0.000018198,0.000016930,0.000015749,0.000014655,0.000013648,0.000012714,0.000011841,0.000011027,0.000010272,0.000009576,0.000008930,0.000008325,0.000007761,0.000007238,0.000006754,0.000006305,0.000005884,0.000005491,0.000005126,0.000004788,0.000004473,0.000004178,0.000003902,0.000003646,0.000003408,0.000003187,0.000002980,0.000002786,0.000002605,0.000002438,0.000002282,0.000002136,0.000001999,0.000001871,0.000001753,0.000001642,0.000001538,0.000001441,0.000001350,0.000001266,0.000001187,0.000001113,0.000001043,0.000000978,0.000000918,0.000000862,0.000000809,0.000000759,0.000000712,0.000000669,0.000000628,0.000000590,0.000000554,0.000000521,0.000000490,0.000000460,0.000000433,0.000000407,0.000000382,0.000000360,0.000000339,0.000000318,0.000000300,0.000000282,0.000000265,0.000000250,0.000000235,0.000000222,0.000000209,0.000000197,0.000000185,0.000000175,0.000000165,0.000000155,0.000000146,0.000000138,0.000000130,0.000000123,0.000000116,0.000000109,0.000000103,0.000000097,0.000000092,0.000000087,0.000000082,0.000000077,0.000000073,0.000000069,0.000000065,0.000000062,0.000000058,0.000000055,0.000000052,0.000000049,0.000000047,0.000000044,0.000000042,0.000000039,0.000000037,0.000000035,0.000000033,0.000000032,0.000000030,0.000000028,0.000000027,0.000000025,0.000000024,0.000000023,0.000000022,0.000000021]
        alpha_ELR_DL=1.3262
        atype="melan-opic"
    Km=683.0015478
    
    wavl_array=[380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780]
    phot_array=[3.90000E-05,4.28264E-05,4.69146E-05,5.15896E-05,5.71764E-05,6.40000E-05,7.23442E-05,8.22122E-05,9.35082E-05,1.06136E-04,1.20000E-04,1.34984E-04,1.51492E-04,1.70208E-04,1.91816E-04,2.17000E-04,2.46907E-04,2.81240E-04,3.18520E-04,3.57267E-04,3.96000E-04,4.33715E-04,4.73024E-04,5.17876E-04,5.72219E-04,6.40000E-04,7.24560E-04,8.25500E-04,9.41160E-04,1.06988E-03,1.21000E-03,1.36209E-03,1.53075E-03,1.72037E-03,1.93532E-03,2.18000E-03,2.45480E-03,2.76400E-03,3.11780E-03,3.52640E-03,4.00000E-03,4.54624E-03,5.15932E-03,5.82928E-03,6.54616E-03,7.30000E-03,8.08651E-03,8.90872E-03,9.76768E-03,1.06644E-02,1.16000E-02,1.25732E-02,1.35827E-02,1.46297E-02,1.57151E-02,1.68400E-02,1.80074E-02,1.92145E-02,2.04539E-02,2.17182E-02,2.30000E-02,2.42946E-02,2.56102E-02,2.69586E-02,2.83513E-02,2.98000E-02,3.13108E-02,3.28837E-02,3.45211E-02,3.62257E-02,3.80000E-02,3.98467E-02,4.17680E-02,4.37660E-02,4.58427E-02,4.80000E-02,5.02437E-02,5.25730E-02,5.49806E-02,5.74587E-02,6.00000E-02,6.26020E-02,6.52775E-02,6.80421E-02,7.09111E-02,7.39000E-02,7.70160E-02,8.02664E-02,8.36668E-02,8.72328E-02,9.09800E-02,9.49176E-02,9.90458E-02,1.03367E-01,1.07885E-01,1.12600E-01,1.17532E-01,1.22674E-01,1.27993E-01,1.33453E-01,1.39020E-01,1.44676E-01,1.50469E-01,1.56462E-01,1.62718E-01,1.69300E-01,1.76243E-01,1.83558E-01,1.91274E-01,1.99418E-01,2.08020E-01,2.17120E-01,2.26735E-01,2.36857E-01,2.47481E-01,2.58600E-01,2.70185E-01,2.82294E-01,2.95051E-01,3.08578E-01,3.23000E-01,3.38402E-01,3.54686E-01,3.71699E-01,3.89288E-01,4.07300E-01,4.25630E-01,4.44310E-01,4.63394E-01,4.82940E-01,5.03000E-01,5.23569E-01,5.44512E-01,5.65690E-01,5.86965E-01,6.08200E-01,6.29346E-01,6.50307E-01,6.70875E-01,6.90842E-01,7.10000E-01,7.28185E-01,7.45464E-01,7.61969E-01,7.77837E-01,7.93200E-01,8.08110E-01,8.22496E-01,8.36307E-01,8.49492E-01,8.62000E-01,8.73811E-01,8.84962E-01,8.95494E-01,9.05443E-01,9.14850E-01,9.23735E-01,9.32092E-01,9.39923E-01,9.47225E-01,9.54000E-01,9.60256E-01,9.66007E-01,9.71261E-01,9.76023E-01,9.80300E-01,9.84092E-01,9.87418E-01,9.90313E-01,9.92812E-01,9.94950E-01,9.96711E-01,9.98098E-01,9.99112E-01,9.99748E-01,1.00000E+00,9.99857E-01,9.99305E-01,9.98326E-01,9.96899E-01,9.95000E-01,9.92601E-01,9.89743E-01,9.86444E-01,9.82724E-01,9.78600E-01,9.74084E-01,9.69171E-01,9.63857E-01,9.58135E-01,9.52000E-01,9.45450E-01,9.38499E-01,9.31163E-01,9.23458E-01,9.15400E-01,9.07006E-01,8.98277E-01,8.89205E-01,8.79782E-01,8.70000E-01,8.59861E-01,8.49392E-01,8.38622E-01,8.27581E-01,8.16300E-01,8.04795E-01,7.93082E-01,7.81192E-01,7.69155E-01,7.57000E-01,7.44754E-01,7.32422E-01,7.20004E-01,7.07497E-01,6.94900E-01,6.82219E-01,6.69472E-01,6.56674E-01,6.43845E-01,6.31000E-01,6.18156E-01,6.05314E-01,5.92476E-01,5.79638E-01,5.66800E-01,5.53961E-01,5.41137E-01,5.28353E-01,5.15632E-01,5.03000E-01,4.90469E-01,4.78030E-01,4.65678E-01,4.53403E-01,4.41200E-01,4.29080E-01,4.17036E-01,4.05032E-01,3.93032E-01,3.81000E-01,3.68918E-01,3.56827E-01,3.44777E-01,3.32818E-01,3.21000E-01,3.09338E-01,2.97850E-01,2.86594E-01,2.75625E-01,2.65000E-01,2.54763E-01,2.44890E-01,2.35334E-01,2.26053E-01,2.17000E-01,2.08162E-01,1.99549E-01,1.91155E-01,1.82974E-01,1.75000E-01,1.67224E-01,1.59646E-01,1.52278E-01,1.45126E-01,1.38200E-01,1.31500E-01,1.25025E-01,1.18779E-01,1.12769E-01,1.07000E-01,1.01476E-01,9.61886E-02,9.11230E-02,8.62649E-02,8.16000E-02,7.71206E-02,7.28255E-02,6.87101E-02,6.47698E-02,6.10000E-02,5.73962E-02,5.39550E-02,5.06738E-02,4.75497E-02,4.45800E-02,4.17587E-02,3.90850E-02,3.65638E-02,3.42005E-02,3.20000E-02,2.99626E-02,2.80766E-02,2.63294E-02,2.47081E-02,2.32000E-02,2.18008E-02,2.05011E-02,1.92811E-02,1.81207E-02,1.70000E-02,1.59038E-02,1.48372E-02,1.38107E-02,1.28348E-02,1.19200E-02,1.10683E-02,1.02734E-02,9.53331E-03,8.84616E-03,8.21000E-03,7.62378E-03,7.08542E-03,6.59148E-03,6.13849E-03,5.72300E-03,5.34306E-03,4.99580E-03,4.67640E-03,4.38008E-03,4.10200E-03,3.83845E-03,3.58910E-03,3.35422E-03,3.13409E-03,2.92900E-03,2.73814E-03,2.55988E-03,2.39324E-03,2.23728E-03,2.09100E-03,1.95359E-03,1.82458E-03,1.70358E-03,1.59019E-03,1.48400E-03,1.38450E-03,1.29127E-03,1.20409E-03,1.12274E-03,1.04700E-03,9.76590E-04,9.11109E-04,8.50133E-04,7.93238E-04,7.40000E-04,6.90083E-04,6.43310E-04,5.99496E-04,5.58455E-04,5.20000E-04,4.83914E-04,4.50053E-04,4.18345E-04,3.88718E-04,3.61100E-04,3.35384E-04,3.11440E-04,2.89166E-04,2.68454E-04,2.49200E-04,2.31302E-04,2.14686E-04,1.99288E-04,1.85048E-04,1.71900E-04,1.59778E-04,1.48604E-04,1.38302E-04,1.28793E-04,1.20000E-04,1.11860E-04,1.04322E-04,9.73356E-05,9.08459E-05,8.48000E-05,7.91467E-05,7.38580E-05,6.89160E-05,6.43027E-05,6.00000E-05,5.59819E-05,5.22256E-05,4.87184E-05,4.54475E-05,4.24000E-05,3.95610E-05,3.69151E-05,3.44487E-05,3.21482E-05,3.00000E-05,2.79913E-05,2.61136E-05,2.43602E-05,2.27246E-05,2.12000E-05,1.97786E-05,1.84529E-05,1.72169E-05,1.60646E-05,1.49900E-05]
#    photometric_unnormalised=1000496.948

    wave_in=[([0]*1) for i in range(54)]
    spd_in=[([0]*1) for i in range(54)]
    wave_mod=[([0]*1) for i in range(41)]
    spd_mod=[([0]*1) for i in range(41)]
    for i in range (0, len(spd_org),1):
        wave_in[i]=spd_org[i].split('\t')[0]
        spd_in[i]=spd_org[i].split('\t')[1]
    for i in range(0,41,1):
        ip=i+8
        wave_mod[i]=float(wave_in[ip])
        spd_mod[i]=float(spd_in[ip])
    inp1=wave_mod[:]
    inp2=spd_mod[:]
    new_len=401
    delta1 = (len(inp1)-1) / (new_len-1)
    delta2 = (len(inp2)-1) / (new_len-1)
    outp1 = [int(interpolate(inp1, i*delta1)) for i in range(new_len)]
    outp2 = [round(interpolate(inp2, i*delta2),6) for i in range(new_len)]
    spd_array=outp2
    interp_1=spd_array 
    pmu_array=[(0*1) for i in range(401)]
    for i in range (0,401,1):
        pmu_array[i]=spd_array[i]*phot_array[i]
    photometric_unnormalised=Km*sum(pmu_array)
    scaling_factor=float(net_illum)/photometric_unnormalised
    #comment the line below later
#    spd_array=[0.91,0.854,0.796533333,0.739066667,0.683066667,0.63,0.58816,0.55048,0.51672,0.48664,0.46,0.430521235,0.40551216,0.386242469,0.373981852,0.37,0.383910309,0.40655284,0.437111358,0.47476963,0.51871142,0.564815234,0.61814361,1.388913503,17.66405407,38.48792157,10.3848472,1.157580262,1.041693124,1.131681244,1.227445988,1.329836296,1.437540988,1.550305926,1.667876975,1.79,1.912442593,2.039923457,2.173183025,2.312961728,2.46,2.61512,2.77896,2.95224,3.13568,3.33,3.554235062,3.786211358,4.022070123,4.257952593,4.49,4.696520494,4.895946667,5.088878025,5.275914074,31.38840628,150.8507165,5.833136863,5.987698765,6.1516,6.307901235,6.459179259,6.600579753,6.730551111,6.847541728,6.95,7.027220741,7.089094321,7.136357531,7.16974716,7.19,7.20144,7.20032,7.18648,7.15976,7.12,7.06192,6.99176,6.91064,6.81968,6.72,6.61368,6.50064,6.38176,6.25792,6.13,5.99984,5.86712,5.73248,5.59656,5.46,5.27672,5.10576,4.95944,4.85008,4.79,4.64176,4.60488,4.72912,5.06424,5.66,7.26824,9.06112,10.91288,12.69776,14.29,15.0192,15.4404,15.564,15.4004,14.96,14.026,12.8928,11.6276,10.2976,8.97,7.97696,7.05448,6.20352,5.42504,4.72,4.10376,3.55928,3.08392,2.67504,2.33,2.06888,1.86064,1.69696,1.56952,1.47,1.36736,1.28168,1.21032,1.15064,1.1,1.04552,0.99736,0.95544,0.91968,0.89,0.85768,0.83344,0.81936,0.817520001,0.830000012,0.853778532,0.897313426,0.963966797,1.057139122,1.180449056,1.373044768,1.601024101,1.880994463,2.277978772,2.978283491,4.417969937,7.401041806,13.10556994,22.70283451,36.51406045,53.02080209,68.6414006,78.78198707,80.13033188,72.72477099,109.3171858,52.09142386,39.51088623,34.84990423,30.99092458,25.4300743,18.35869374,11.80584741,7.317933846,4.956282276,3.924594297,3.483599237,3.232815675,3.027162639,2.830194735,2.634300381,2.445312403,2.267197392,2.104055619,1.96,1.833540625,1.735796094,1.67228125,1.648510938,1.67,1.748485781,1.881705,2.073616875,2.328180625,2.649355469,4.742986502,9.110672451,4.138900009,26.02042266,9.746927064,6.077657033,6.793250498,9.853206666,31.2234949,17.85279587,10.04647447,10.88739637,11.6791575,12.31128609,12.73,12.43407531,11.92903384,11.2729552,10.52391717,9.740000005,9.10219,8.5149325,8.00558,7.601485,7.33,7.4496375,7.6988,8.04705,8.46395,8.9190625,9.27358,9.6325275,9.99256,28.87144063,177.2063008,11.0457175,11.37664,32.72195821,179.5629519,17.44357547,12.50657,12.72291,12.90884,13.0619925,13.18,13.34183938,13.44346266,13.46216625,13.37524656,13.16,12.59675547,11.90901875,11.12332813,10.57699824,23.33953365,8.807677064,7.623888125,6.75965875,5.917235469,5.11,4.337796563,3.63092875,3.006162656,2.480264375,2.07,1.93408,1.91184,1.98456,2.13352,2.34,2.59936,2.87528,3.14552,3.38784,3.58,3.5516,3.4656,3.3368,3.18,3.01,2.896,2.7848,2.6776,2.5756,2.48,2.4112,2.3464,2.282,2.2144,2.14,2.02,1.8948,1.7696,1.6496,1.54,1.4684,1.412,1.3704,1.3432,1.33,1.32848,1.34064,1.36656,1.40632,1.46,1.55264,1.65312,1.75528,1.85296,1.94,1.99968,2.03904,2.05456,2.04272,2,1.85088,1.68184,1.50736,1.34192,1.2,1.1012,1.0536,1.0704,1.1648,1.35,1.81584,2.35472,2.93568,3.52776,4.1,4.60256,5.02808,5.35032,5.54304,5.58,5.14824,4.57992,3.92048,3.21536,2.51,2.01528,1.56984,1.17776,0.84312,0.57,0.42296,0.33048,0.28152,0.26504,0.27,0.24888,0.23624,0.23016,0.22872,0.23,0.22344,0.21792,0.21368,0.21096,0.21,0.21456,0.22048,0.22712,0.23384,0.24,0.24272,0.24416,0.24424,0.24288,0.24,0.23136,0.22208,0.21312,0.20544,0.2,0.20288,0.20864,0.21696,0.22752,0.24,0.25856,0.27728,0.29472,0.30944,0.32,0.316,0.3072,0.2944,0.2784,0.26,0.24,0.2192,0.1984,0.1784,0.16,0.1488,0.1396,0.132,0.1256,0.12,0.113733333,0.107733333,0.101866667,0.096,0.09]
    radiometric_array=[scaling_factor*i for i in (spd_array)]
    num_wt=[(1*1) for i in range(401)]
    a_opic_rad=[(0*1) for i in range(401)]
    illuminance_array=[(0*1) for i in range(401)]
    for i in range (0,401,1):
        a_opic_rad[i]=num_wt[i]*radiometric_array[i]*opic_array[i]
        illuminance_array[i]=num_wt[i]*radiometric_array[i]*phot_array[i]
    a_opic_rad_sum=sum(a_opic_rad)
    illuminance_sum=sum(illuminance_array)*683
    a_opic_ELR=round(1000*float(a_opic_rad_sum/illuminance_sum),4)
    a_opic_ELR_DL=alpha_ELR_DL
    a_opic_DER=round(a_opic_ELR/a_opic_ELR_DL,4)
    a_opic_EDI=illuminance_sum*a_opic_DER
    illuminance_sum=round(illuminance_sum,2)
    a_opic_rad_sum=round(a_opic_rad_sum,2)
    a_opic_EDI=round(a_opic_EDI,2)
    return illuminance_sum,a_opic_rad_sum,a_opic_ELR,a_opic_DER,a_opic_EDI,interp_1,atype

if True:
    spd_org=spd_input
    alpha_type=5 if alpha_type is None else int(alpha_type)
    if alpha_type>5:
        alpha_type=5
    elif alpha_type<1:
        alpha_type=5
    net_illum=1000 if net_illum is None else float(net_illum)
    illuminance,a_opic_irradiance,a_opic_ELR,a_opic_DER,a_opic_EDI,SPD_1,a_opic_type=main(spd_org,alpha_type,net_illum)